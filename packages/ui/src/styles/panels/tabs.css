/* Primary tab strip */
.tab-bar {
  @apply border-b;
  border-color: var(--border-base);
}

.tab-bar-instance {
  background-color: var(--surface-secondary);
}

.tab-bar-session {
  background-color: var(--surface-base);
}

.tab-container {
  @apply flex items-center justify-between gap-1 px-2 py-1;
}

.tab-scroll {
  @apply w-full;
  overflow-x: auto;
}

.tab-strip {
  @apply flex items-center gap-2 px-1;
  min-width: 100%;
}

.tab-strip-tabs {
  @apply flex items-center gap-1 flex-shrink-0;
}

.tab-strip-spacer {
  @apply flex-1;
  min-width: 1px;
}

.tab-shortcuts {
  @apply flex items-center gap-2 flex-shrink-0;
}

.tab-remote-button {
  @apply flex-shrink-0;
}

.tab-base {
  @apply inline-flex items-center gap-2 px-3 py-2 rounded-t-md max-w-[200px] transition-colors text-sm font-medium;
  font-family: var(--font-family-sans);
  outline: none;
}

.tab-base:focus-visible {
  @apply ring-2 ring-offset-1;
  ring-color: var(--accent-primary);
  ring-offset-color: var(--surface-base);
}

.tab-active {
  background-color: var(--tab-active-bg);
  color: var(--tab-active-text);
}

.tab-inactive {
  background-color: var(--tab-inactive-bg);
  color: var(--tab-inactive-text);
}

.tab-inactive:hover {
  background-color: var(--tab-inactive-hover-bg);
}

.tab-active:hover {
  background-color: var(--tab-active-hover-bg);
}

.tab-label {
  @apply truncate;
}

.tab-close {
  @apply opacity-100 hover:bg-red-500 hover:text-white rounded p-0.5 transition-all cursor-pointer;
}

.tab-close:focus-visible {
  @apply ring-2 ring-offset-1;
  ring-color: var(--accent-primary);
  ring-offset-color: inherit;
}

.new-tab-button {
  @apply inline-flex items-center justify-center w-8 h-8 rounded-md transition-colors;
  background-color: var(--new-tab-bg);
  color: var(--new-tab-text);
}

.new-tab-button:hover {
  background-color: var(--new-tab-hover-bg);
}

.new-tab-button:focus-visible {
  @apply ring-2 ring-offset-1;
  ring-color: var(--accent-primary);
  ring-offset-color: var(--surface-base);
}

/* Session tabs */
.session-tab-base {
  @apply inline-flex items-center gap-2 px-3 py-1.5 rounded-t-md max-w-[150px] transition-colors text-sm;
  font-family: var(--font-family-sans);
  outline: none;
  border-bottom: 2px solid transparent;
}

.session-tab-base:focus-visible {
  @apply ring-2 ring-offset-1;
  ring-color: var(--accent-primary);
  ring-offset-color: var(--surface-base);
}

.session-tab-active {
  background-color: var(--session-tab-active-bg);
  border-bottom-color: var(--accent-primary);
  color: var(--session-tab-active-text);
  font-weight: var(--font-weight-medium);
}

.session-tab-inactive {
  color: var(--session-tab-inactive-text);
}

.session-tab-inactive:hover {
  background-color: var(--session-tab-hover-bg);
}

.session-tab-special {
  color: var(--session-tab-inactive-text);
}

/* Project tab bar - browser-like tabs */
.project-tab-bar {
  @apply flex items-center h-10 px-1;
  background-color: var(--surface-secondary);
  border-bottom: 1px solid var(--border-base);
  -webkit-app-region: drag;
}

.project-tab-bar > * {
  -webkit-app-region: no-drag;
}

.project-tab-scroll-container {
  @apply flex-1 overflow-x-auto;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.project-tab-scroll-container::-webkit-scrollbar {
  display: none;
}

.project-tab-list {
  @apply flex items-center gap-0.5 h-full;
}

.project-tab-scroll-arrow {
  @apply flex items-center justify-center w-6 h-6 rounded transition-colors flex-shrink-0;
  color: var(--text-secondary);
}

.project-tab-scroll-arrow:hover {
  background-color: var(--surface-hover);
  color: var(--text-primary);
}

.project-tab-scroll-left {
  @apply mr-1;
}

.project-tab-scroll-right {
  @apply ml-1;
}

.project-tab {
  @apply inline-flex items-center gap-2 px-3 h-8 rounded-md text-sm font-medium transition-colors cursor-pointer;
  max-width: 180px;
  font-family: var(--font-family-sans);
  outline: none;
}

.project-tab:focus-visible {
  @apply ring-2 ring-offset-1;
  ring-color: var(--accent-primary);
  ring-offset-color: var(--surface-secondary);
}

.project-tab-active {
  background-color: var(--surface-base);
  color: var(--text-primary);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.project-tab-inactive {
  background-color: transparent;
  color: var(--text-secondary);
}

.project-tab-inactive:hover {
  background-color: var(--surface-hover);
  color: var(--text-primary);
}

.project-tab-label {
  @apply truncate;
}

.project-tab-close {
  @apply opacity-40 hover:opacity-100 hover:bg-red-500 hover:text-white rounded p-0.5 transition-all cursor-pointer ml-1;
}

.project-tab:hover .project-tab-close {
  @apply opacity-70;
}

.project-tab-active .project-tab-close {
  @apply opacity-50;
}

.project-tab-close:focus-visible {
  @apply opacity-100 ring-2 ring-offset-1;
  ring-color: var(--accent-primary);
}

.project-tab-new {
  @apply inline-flex items-center justify-center w-7 h-7 rounded-md transition-colors flex-shrink-0 ml-1;
  color: var(--text-secondary);
}

.project-tab-new:hover {
  background-color: var(--surface-hover);
  color: var(--text-primary);
}

.project-tab-new:focus-visible {
  @apply ring-2 ring-offset-1;
  ring-color: var(--accent-primary);
  ring-offset-color: var(--surface-secondary);
}

.project-tab-settings {
  @apply relative inline-flex items-center justify-center w-8 h-8 rounded-md transition-colors flex-shrink-0 mr-1;
  color: var(--text-secondary);
}

.project-tab-settings:hover {
  background-color: var(--surface-hover);
  color: var(--text-primary);
}

.project-tab-settings:focus-visible {
  @apply ring-2 ring-offset-1;
  ring-color: var(--accent-primary);
  ring-offset-color: var(--surface-secondary);
}

.project-tab-status-dot {
  @apply absolute bottom-1 right-1 w-2 h-2 rounded-full;
}

/* Project tab icon wrapper for status dot positioning */
.project-tab-icon-wrapper {
  @apply relative flex-shrink-0;
  width: 16px;
  height: 16px;
}

.project-tab-icon-wrapper svg {
  width: 100%;
  height: 100%;
}

/* Project status dots */
.project-status-dot {
  @apply absolute rounded-full;
  width: 7px;
  height: 7px;
  bottom: -2px;
  right: -2px;
  box-shadow: 0 0 0 1.5px var(--surface-secondary);
}

.project-tab-active .project-status-dot {
  box-shadow: 0 0 0 1.5px var(--surface-base);
}

/* Idle/ready status - green */
.project-status-dot-idle {
  background-color: #22c55e;
}

/* Working/in-progress status - blue with animation */
.project-status-dot-working {
  background-color: #3b82f6;
  animation: status-dot-pulse 1.5s ease-in-out infinite;
}

/* Error/permission status - red */
.project-status-dot-error {
  background-color: #ef4444;
  animation: status-dot-pulse 1s ease-in-out infinite;
}

/* Session tab bar - nested horizontal tabs */
.session-tab-bar {
  @apply flex items-center h-9 px-2;
  background-color: var(--surface-base);
  border-bottom: 1px solid var(--border-base);
}

.session-tab-scroll-container {
  @apply flex-1 overflow-x-auto;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.session-tab-scroll-container::-webkit-scrollbar {
  display: none;
}

.session-tab-list {
  @apply flex items-center gap-1 h-full;
}

.session-tab-scroll-arrow {
  @apply flex items-center justify-center w-5 h-5 rounded transition-colors flex-shrink-0;
  color: var(--text-secondary);
}

.session-tab-scroll-arrow:hover {
  background-color: var(--surface-hover);
  color: var(--text-primary);
}

.session-tab-scroll-left {
  @apply mr-1;
}

.session-tab-scroll-right {
  @apply ml-1;
}

.session-tab {
  @apply inline-flex items-center gap-1.5 px-2.5 h-7 rounded text-xs font-medium transition-colors cursor-pointer;
  max-width: 220px; /* Increased from 160px for better readability */
  font-family: var(--font-family-sans);
  outline: none;
}

.session-tab:focus-visible {
  @apply ring-2 ring-offset-1;
  ring-color: var(--accent-primary);
  ring-offset-color: var(--surface-base);
}

.session-tab-active {
  background-color: var(--accent-primary);
  color: var(--accent-primary-text, white);
}

.session-tab-inactive {
  background-color: transparent;
  color: var(--text-secondary);
}

.session-tab-inactive:hover {
  background-color: var(--surface-hover);
  color: var(--text-primary);
}

.session-tab-label {
  @apply truncate;
}

.session-tab-close {
  @apply opacity-40 hover:opacity-100 rounded p-0.5 transition-all cursor-pointer;
}

.session-tab:hover .session-tab-close {
  @apply opacity-70;
}

.session-tab-active .session-tab-close {
  @apply opacity-60;
}

.session-tab-active .session-tab-close:hover {
  background-color: rgba(255, 255, 255, 0.3);
}

.session-tab-inactive .session-tab-close:hover {
  @apply bg-red-500 text-white;
}

.session-tab-close:focus-visible {
  @apply opacity-100 ring-2 ring-offset-1;
  ring-color: var(--accent-primary);
}

.session-tab-new {
  @apply inline-flex items-center gap-1 px-2 h-7 rounded text-xs transition-colors flex-shrink-0;
  color: var(--text-secondary);
}

.session-tab-new:hover {
  background-color: var(--surface-hover);
  color: var(--text-primary);
}

.session-tab-new:focus-visible {
  @apply ring-2 ring-offset-1;
  ring-color: var(--accent-primary);
  ring-offset-color: var(--surface-base);
}

.session-tab-new-label {
  @apply hidden sm:inline;
}

/* Session status indicators */
.session-tab-working {
  animation: session-pulse 1.5s ease-in-out infinite;
}

.session-tab-compacting {
  opacity: 0.7;
}

@keyframes session-pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.7;
  }
}

/* Session tab icon wrapper for status dot positioning */
.session-tab-icon-wrapper {
  @apply relative flex-shrink-0;
  width: 14px;
  height: 14px;
}

.session-tab-icon-wrapper svg {
  width: 100%;
  height: 100%;
}

/* Session status dots */
.session-status-dot {
  @apply absolute rounded-full;
  width: 6px;
  height: 6px;
  bottom: -2px;
  right: -2px;
  box-shadow: 0 0 0 1.5px var(--surface-base);
}

.session-tab-active .session-status-dot {
  box-shadow: 0 0 0 1.5px var(--accent-primary);
}

/* Idle/ready status - green */
.session-status-dot-idle {
  background-color: #22c55e;
}

/* Working/in-progress status - blue with animation */
.session-status-dot-working {
  background-color: #3b82f6;
  animation: status-dot-pulse 1.5s ease-in-out infinite;
}

/* Error/permission status - red */
.session-status-dot-error {
  background-color: #ef4444;
  animation: status-dot-pulse 1s ease-in-out infinite;
}

@keyframes status-dot-pulse {
  0%, 100% {
    opacity: 1;
    transform: scale(1);
  }
  50% {
    opacity: 0.6;
    transform: scale(0.85);
  }
}

/* Session tab badge for child count */
.session-tab-badge {
  @apply inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded-full text-xs cursor-pointer transition-all ml-1;
  font-size: 10px;
  background-color: var(--surface-secondary);
  color: var(--text-secondary);
  border: 1px solid transparent;
}

.session-tab-badge:hover {
  background-color: var(--surface-hover);
  border-color: var(--border-base);
  transform: scale(1.05);
}

.session-tab-active .session-tab-badge {
  background-color: rgba(255, 255, 255, 0.2);
  color: inherit;
}

.session-tab-active .session-tab-badge:hover {
  background-color: rgba(255, 255, 255, 0.3);
}

.session-tab-badge-indicator {
  @apply flex-shrink-0;
}

.session-tab-badge-count {
  @apply font-medium;
}

.session-tab-badge-working .session-tab-badge-indicator {
  color: var(--accent-primary);
  animation: badge-pulse 1.5s ease-in-out infinite;
}

.session-tab-badge-permission {
  background-color: var(--warning-bg, #fef3c7);
  color: var(--warning-text, #92400e);
}

.session-tab-active .session-tab-badge-permission {
  background-color: rgba(254, 243, 199, 0.9);
  color: #92400e;
}

.session-tab-badge-compacting {
  opacity: 0.8;
}

@keyframes badge-pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

/* Session tab dropdown container */
.session-tab-dropdown-container {
  @apply relative;
}

/* Session tab dropdown */
.session-tab-dropdown {
  @apply absolute top-full left-0 mt-1 z-50 min-w-[240px] rounded-lg shadow-lg border overflow-hidden;
  background-color: var(--surface-base);
  border-color: var(--border-base);
  /* Prevent overflow on right edge - dropdown will be repositioned if needed */
  max-width: calc(100vw - 2rem);
}

/* Animation for dropdown */
.session-tab-dropdown {
  animation: dropdown-slide-in 0.15s ease-out;
}

@keyframes dropdown-slide-in {
  from {
    opacity: 0;
    transform: translateY(-4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.session-dropdown-header {
  @apply px-3 py-2;
}

.session-dropdown-title {
  @apply text-sm font-medium;
  color: var(--text-primary);
}

.session-dropdown-divider {
  @apply border-t;
  border-color: var(--border-base);
}

.session-dropdown-list {
  @apply py-1 max-h-[200px] overflow-y-auto;
}

.session-dropdown-item {
  @apply flex items-center gap-2 w-full px-3 py-2 text-left text-sm transition-colors cursor-pointer;
  background-color: transparent;
  color: var(--text-primary);
}

.session-dropdown-item:hover {
  background-color: var(--surface-hover);
}

.session-dropdown-item-status {
  @apply flex-shrink-0 w-4 text-center;
  font-size: 10px;
}

.session-dropdown-item-label {
  @apply flex-1 truncate;
}

.session-dropdown-item-state {
  @apply text-xs flex-shrink-0;
  color: var(--text-tertiary);
}

.session-dropdown-item-working .session-dropdown-item-status {
  color: var(--accent-primary);
  animation: badge-pulse 1.5s ease-in-out infinite;
}

.session-dropdown-item-permission {
  background-color: var(--warning-bg, #fef3c7);
}

.session-dropdown-item-permission .session-dropdown-item-state {
  color: var(--warning-text, #92400e);
  font-weight: 500;
}

.session-dropdown-item-parent {
  color: var(--text-secondary);
}

/* Session Breadcrumb - shown when viewing a child session */
.session-breadcrumb {
  @apply flex items-center gap-2 h-9 px-3;
  background-color: var(--surface-base);
  border-bottom: 1px solid var(--border-base);
}

.session-breadcrumb-parent {
  @apply inline-flex items-center gap-1.5 px-2 py-1 rounded text-xs font-medium transition-colors cursor-pointer;
  background-color: var(--surface-secondary);
  color: var(--text-secondary);
}

.session-breadcrumb-parent:hover {
  background-color: var(--surface-hover);
  color: var(--text-primary);
}

.session-breadcrumb-parent-label {
  @apply truncate max-w-[120px];
}

.session-breadcrumb-siblings {
  @apply flex items-center gap-1 flex-1 min-w-0 overflow-x-auto;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.session-breadcrumb-siblings::-webkit-scrollbar {
  display: none;
}

.session-sibling-tab {
  @apply inline-flex items-center gap-1.5 px-2 py-1 rounded text-xs transition-colors cursor-pointer flex-shrink-0;
  background-color: transparent;
  color: var(--text-secondary);
}

.session-sibling-tab:hover {
  background-color: var(--surface-hover);
  color: var(--text-primary);
}

.session-sibling-tab-active {
  background-color: var(--accent-primary);
  color: var(--accent-primary-text, white);
  font-weight: var(--font-weight-medium);
}

.session-sibling-tab-working .session-sibling-tab-indicator {
  color: var(--accent-primary);
  animation: badge-pulse 1.5s ease-in-out infinite;
}

.session-sibling-tab-permission {
  background-color: var(--warning-bg, #fef3c7);
  color: var(--warning-text, #92400e);
}

.session-sibling-tab-label {
  @apply truncate max-w-[100px];
}

.session-sibling-tab-indicator {
  font-size: 10px;
}

.session-breadcrumb-status {
  @apply flex-shrink-0 ml-auto;
}

.session-breadcrumb-status-text {
  @apply text-xs;
}

.text-warning {
  color: var(--warning-text, #92400e);
}

.text-accent {
  color: var(--accent-primary);
}

.text-muted {
  color: var(--text-tertiary);
}

/* Sub-agent footer - shown instead of prompt input for sub-agent sessions */
.sub-agent-footer {
  @apply flex items-center justify-between gap-4 px-4 py-3;
  background-color: var(--surface-secondary);
  border-top: 1px solid var(--border-base);
}

.sub-agent-footer-message {
  @apply flex items-center gap-2;
}

.sub-agent-footer-icon {
  @apply text-lg;
}

.sub-agent-footer-text {
  @apply text-sm;
  color: var(--text-secondary);
}

.sub-agent-footer-button {
  @apply inline-flex items-center gap-2 px-3 py-1.5 rounded-md text-sm font-medium transition-colors;
  background-color: var(--accent-primary);
  color: var(--accent-primary-text, white);
}

.sub-agent-footer-button:hover {
  background-color: var(--accent-primary-hover);
}

.sub-agent-footer-button:focus-visible {
  @apply ring-2 ring-offset-2;
  ring-color: var(--accent-primary);
  ring-offset-color: var(--surface-secondary);
}

/* Mobile Optimizations for Session Tree */
@media (max-width: 768px) {
  /* Larger touch targets for session tabs */
  .session-tab {
    @apply py-2.5 px-3;
    min-height: 44px; /* iOS recommended touch target */
  }

  .session-tab-label {
    max-width: 100px; /* Shorter labels on mobile */
  }

  .session-tab-close {
    @apply w-7 h-7 -mr-1;
    min-width: 44px;
    min-height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* Larger badge for touch */
  .session-tab-badge {
    @apply px-2 py-1;
    min-height: 32px;
    font-size: 11px;
  }

  .session-tab-badge svg {
    @apply w-4 h-4;
  }

  /* Full-width dropdown on mobile */
  .session-tab-dropdown {
    position: fixed;
    left: 0;
    right: 0;
    top: auto;
    bottom: 0;
    max-width: 100%;
    width: 100%;
    border-radius: 12px 12px 0 0;
    max-height: 60vh;
    animation: dropdown-slide-up 0.2s ease-out;
  }

  @keyframes dropdown-slide-up {
    from {
      opacity: 0;
      transform: translateY(100%);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .session-dropdown-item {
    @apply py-3 px-4;
    min-height: 48px;
  }

  .session-dropdown-item-status {
    font-size: 14px;
    width: 24px;
  }

  .session-dropdown-item-label {
    @apply text-base;
    max-width: none;
  }

  .session-dropdown-item-state {
    @apply text-sm;
  }

  /* Breadcrumb mobile optimization */
  .session-breadcrumb {
    @apply flex-wrap h-auto py-2;
  }

  .session-breadcrumb-parent {
    @apply py-2 px-3;
    min-height: 40px;
  }

  .session-breadcrumb-siblings {
    @apply w-full mt-2;
  }

  .session-sibling-tab {
    @apply py-2 px-3;
    min-height: 40px;
  }

  /* Sub-agent footer mobile */
  .sub-agent-footer {
    @apply flex-col items-start py-4;
  }

  .sub-agent-footer-button {
    @apply w-full justify-center py-3 mt-3;
    min-height: 44px;
  }
}

/* Touch-friendly hover states (remove hover on touch devices) */
@media (hover: none) {
  .session-tab:hover {
    background-color: inherit;
  }

  .session-tab-badge:hover {
    transform: none;
  }

  .session-dropdown-item:hover {
    background-color: inherit;
  }

  /* Use active states instead for touch */
  .session-tab:active {
    background-color: var(--surface-hover);
  }

  .session-tab-badge:active {
    background-color: var(--surface-hover);
    transform: scale(0.95);
  }

  .session-dropdown-item:active {
    background-color: var(--surface-hover);
  }
}
